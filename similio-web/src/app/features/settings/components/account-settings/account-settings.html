<div class="max-w-3xl animate-in fade-in duration-500 space-y-10">

  <form [formGroup]="infoForm" (ngSubmit)="onInfoSubmit()">
    <app-form-section title="Dane kontaktowe" subtitle="Służą do logowania i kontaktu.">
      <div class="space-y-6">

        <app-input-field
          label="Adres e-mail"
          placeholder="twoj@email.com"
          [control]="getControl(infoForm, 'email')">
        </app-input-field>

        <div class="w-full">
          <div>
            <label class="block text-sm font-semibold text-[#002f34] mb-1.5">Telefon</label>
            <div class="flex bg-[#f2f4f5] border-b-2 border-transparent focus-within:border-[#002f34] rounded-t-md overflow-hidden transition-all"
                 [class.!border-red-500]="infoForm.get('phoneNumber')?.invalid && infoForm.get('phoneNumber')?.touched">

              <select
                formControlName="countryCode"
                class="bg-transparent border-r border-gray-200 px-3 py-3 text-[#002f34] text-sm focus:outline-none cursor-pointer appearance-none min-w-[80px]"
              >
                @for (country of countries; track country.code) {
                  <option [value]="country.code">
                    {{ country.flag }} {{ country.code }}
                  </option>
                }
              </select>

              <input
                type="tel"
                formControlName="phone"
                class="bg-transparent px-4 py-3 text-[#002f34] outline-none placeholder-gray-400"
                placeholder="123 456 789"
              />
            </div>
            @if (infoForm.get('phone')?.invalid && infoForm.get('phone')?.touched) {
              <p class="text-red-500 mt-1 text-xs font-light animate-in slide-in-from-top-1">
                * Proszę podać prawidłowy numer telefonu
              </p>
            }
          </div>
        </div>

<!--        <div class="flex justify-end pt-2">-->
<!--          <app-button-->
<!--            type="submit"-->
<!--            [disabled]="infoForm.invalid || infoForm.pristine || loading()"-->
<!--            [isLoading]="loading()">-->
<!--            Zapisz dane-->
<!--          </app-button>-->
<!--        </div>-->

      </div>
    </app-form-section>
  </form>

  <form [formGroup]="passwordForm" (ngSubmit)="onPasswordSubmit()">
    <app-form-section title="Zmiana hasła" subtitle="Zadbaj o silne hasło dla bezpieczeństwa.">
      <div class="space-y-6">

        <app-input-field
          label="Obecne hasło"
          type="password"
          [control]="getControl(passwordForm, 'currentPassword')">
        </app-input-field>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <app-input-field
            label="Nowe hasło"
            type="password"
            [control]="getControl(passwordForm, 'newPassword')">
          </app-input-field>

          <app-input-field
            label="Powtórz nowe hasło"
            type="password"
            [control]="getControl(passwordForm, 'confirmPassword')">
          </app-input-field>
        </div>

        @if (passwordForm.hasError('mismatch') && passwordForm.get('confirmPassword')?.touched) {
          <p class="text-red-500 text-xs pl-1">Hasła nie są identyczne.</p>
        }

        <div class="flex justify-end pt-2">
          <app-button
            type="submit"
            [disabled]="passwordForm.invalid || loading()"
            [isLoading]="loading()">
            Zmień hasło
          </app-button>
        </div>

      </div>
    </app-form-section>
  </form>

  <div class="pt-6 border-t border-gray-200">
    <h3 class="text-red-600 font-medium mb-2">Usuwanie konta</h3>
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 bg-red-50 p-4 rounded-md border border-red-100">
      <div class="text-sm text-red-800">
        <p class="font-bold">Chcesz usunąć swoje konto?</p>
        <p class="mt-1 opacity-80">Ta operacja jest nieodwracalna.</p>
      </div>

      <button
        (click)="onDeleteAccount()"
        type="button"
        class="text-red-600 text-sm font-bold border border-red-200 bg-white px-4 py-2 rounded hover:bg-red-50 transition-colors whitespace-nowrap"
      >
        Usuń trwale
      </button>
    </div>
  </div>

</div>
